# APLAutoHotKey
Application to generate AutoHotKey scripts to enable APL glyph keyboard input

## Usage
1. Obtain the URL for the latest release workspace fromt the [Releases page](https://github.com/rikedyp/APLAutoHotKey/releases) and import APLAutoHotKey:

  ```
   ]Get -t=APLAutoHotKey -u https://github.com/rikedyp/APLAutoHotKey/releases/download/v0.0.0/APLAutoHotKey-0.0.0.dws
  ```

2. Set options

  ```
   opt←⎕NS⍬
   opt.shifts←'CapsLock' 'RAlt'
   opt.layout←'en_GB'
   opt.outpath←'/tmp/APL-en_GB-CapsLockAlt.ahk'
  ```
  
3. Build script

  ```
         APLAutoHotKey.Build opt
   ┌─┬──────────────────────────────────────────────────┐
   │0│Saved: /tmp/APL-en_GB-CapsLockAlt.ahk (9404 bytes)│
   └─┴──────────────────────────────────────────────────┘
  ```
  
## TODO
- [x] Enumerate options
- [ ] Test individual options
- [ ] Test combinations of options
- [ ] Suspend key combination + suspend when Classic window active

## Options

### Layouts
- [x] en_GB
- [x] en_US
- [x] da_DK
- [x] de_DE
- [x] es_ES
- [x] fr_FR
- [ ] it_IT
- [ ] fi_FI
- [ ] sv_SE

> Other layouts can be supported on request, or generated by the user if they create the appropriate key map

- [ ] Check IME matches https://dfns.dyalog.com/n_keyboards.htm (⍺ ⍵ French)

### Shifting key
This is a key which, while pressed, enables the input of APL glyphs. For example, <kbd>Ctrl + e</kbd> produces `∊`.

- [x] CapsLock
- [x] Left Control
- [x] Right Control
- [x] Control (both)
- [x] Left Alt
- [x] Right Alt
- [x] Alt (both)
- [ ] LWin
- [ ] RWin
- [ ] Win (both)
- [ ] AltGr
- [ ] Can translate JS key code into AHK SC scan code?

> AltGr sends a LCtrl+LAlt signal. AltGr and LAlt can get different behaviours by mapping `<^>!::RAlt` and using `LAlt` and `RAlt`. If both Left Alt and Right Alt are selected, then a single `Alt` hotkey is used, but if only Left Alt is selected, then `AltGr` must be remapped to `RAlt`. TODO: does this affect e.g. accents or special characters via AltGr on regular Windows keyboard?
> Use of `LCtrl`, `Ctrl`, `RAlt` or `Alt` can interfere with `AltGr` behaviour

### Suspend
The user may specify a key combination to toggle suspension of hotkeys, which may be useful if an application uses keyboard shortcuts with which the hotkeys interfere.

#### Dyalog Classic Edition
If a Control (<kbd>Ctrl</kbd>) key is used as the APL shifting key, Dyalog Classic interpreters fail to register keyboard input for APL glyphs while the hotkeys are active. This is avoided by suspending AutoHotKey while Dyalog Classic interpreter windows are active.

The build script checks the Microsoft Windows registry for installations of Dyalog Classic interpreters, and adds the paths to their executable files to the "Classic" group. When a Classic window is active, hotkeys suspend to allow classic.

If a user installs a Dyalog Classic interpreter, then they can either rebuild their script using APLAutoHotKey, or add the path to the executable file in an additional `GroupAdd` line in their script.
